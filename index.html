<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Watchlist - å…¨çƒå¸‚åœºè¿½è¸ª</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-header: #1a1a2e;
            --bg-section: #f0f0f0;
            --text-primary: #333;
            --text-secondary: #666;
            --text-muted: #888;
            --border-color: #e0e0e0;
            --accent: #FFB800;
            --positive: #28a745;
            --positive-bg: #d4edda;
            --negative: #dc3545;
            --negative-bg: #f8d7da;
        }
        
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #0a0a0a;
                --bg-secondary: #141414;
                --bg-header: #000;
                --bg-section: #1a1a1a;
                --text-primary: #e0e0e0;
                --text-secondary: #aaa;
                --text-muted: #666;
                --border-color: #333;
                --accent: #FFB800;
                --positive: #00d084;
                --positive-bg: rgba(0,208,132,0.1);
                --negative: #ff4757;
                --negative-bg: rgba(255,71,87,0.1);
            }
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 12px;
            line-height: 1.4;
        }
        
        /* é¡¶éƒ¨æ ‡é¢˜åŒº */
        .main-header {
            background: var(--bg-header);
            color: #fff;
            padding: 15px 20px;
            border-bottom: 3px solid var(--accent);
        }
        
        .main-header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .header-desc {
            font-size: 13px;
            color: #aaa;
            line-height: 1.6;
            max-width: 900px;
        }
        
        .header-meta-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #333;
            font-size: 11px;
            color: #888;
        }
        
        .refresh-btn {
            background: var(--accent);
            color: #000;
            border: none;
            padding: 4px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
        }
        
        /* å†…å®¹åŒº */
        .container {
            padding: 0;
        }
        
        /* åˆ†ç»„æ ‡é¢˜ */
        .section {
            margin: 0;
            border-bottom: 2px solid var(--border-color);
        }
        
        .section-title {
            background: var(--accent);
            color: #000;
            padding: 6px 15px;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        .section-desc {
            background: var(--bg-section);
            padding: 8px 15px;
            font-size: 11px;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        
        /* è¡¨æ ¼ */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            table-layout: auto;
        }
        
        th {
            background: var(--bg-secondary);
            padding: 8px 6px;
            text-align: left;
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
        }
        
        th:nth-child(2) {
            width: auto;
            min-width: 200px;
        }
        
        th:last-child { text-align: right; }
        
        td {
            padding: 10px 6px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
        }
        
        tr:hover { background: var(--bg-secondary); }
        
        .ticker {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 12px;
        }
        
        .name {
            color: var(--text-secondary);
            font-size: 11px;
            line-height: 1.5;
            min-width: 180px;
        }
        
        .name .ename {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 12px;
            display: block;
            word-wrap: break-word;
            white-space: normal;
            line-height: 1.3;
        }
        
        .name .cdesc {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 3px;
            display: block;
            word-wrap: break-word;
            white-space: normal;
            line-height: 1.2;
        }
        
        .price {
            font-weight: 600;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .change {
            font-weight: 600;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            padding: 2px 4px;
            border-radius: 2px;
        }
        
        .positive { 
            color: var(--positive); 
            background: var(--positive-bg);
        }
        
        .negative { 
            color: var(--negative); 
            background: var(--negative-bg);
        }
        
        .neutral {
            color: var(--text-muted);
        }
        
        .sparkline {
            width: 50px;
            height: 20px;
        }
        
        .ytd {
            text-align: right;
            font-weight: 600;
            font-family: 'Courier New', monospace;
            padding-right: 8px;
        }
        
        /* åº•éƒ¨è¯´æ˜ */
        .footer-note {
            background: var(--bg-secondary);
            padding: 15px;
            font-size: 10px;
            color: var(--text-muted);
            line-height: 1.6;
            border-top: 2px solid var(--border-color);
        }
        
        .footer-note strong {
            color: var(--text-primary);
        }
        
        /* åŠ è½½ */
        .loading {
            text-align: center;
            padding: 50px;
            color: var(--text-muted);
        }
        
        @media (max-width: 768px) {
            .main-header h1 { font-size: 18px; }
            .header-desc { font-size: 11px; }
            .section-title { font-size: 12px; }
            table { table-layout: auto; }
            th:nth-child(2) {
                width: auto;
                min-width: 180px;
            }
            .name { 
                width: auto;
                min-width: 180px;
                max-width: none;
            }
            .name .ename {
                font-size: 10px;
                white-space: normal;
                word-wrap: break-word;
                line-height: 1.3;
            }
            .name .cdesc {
                display: block;
                font-size: 8px;
                white-space: normal;
                word-wrap: break-word;
                margin-top: 2px;
                line-height: 1.2;
            }
            th, td { 
                padding: 8px 4px;
                font-size: 9px;
            }
            th:first-child, td:first-child {
                padding-left: 8px;
            }
            .ticker { font-size: 11px; }
            .price { font-size: 10px; }
            .change { font-size: 9px; }
            .ytd { font-size: 9px; }
            .sparkline { width: 30px; height: 14px; }
        }
    </style>
</head>
<body>
    <div class="main-header">
        <h1>ğŸ“Š å…¨çƒå¸‚åœºè¿½è¸ªçœ‹æ¿ <span style="font-size:14px;opacity:0.7;font-weight:400">Market Watchlist</span></h1>
        <div class="header-desc">
            è·¨è¶Šåœ°åŸŸä¸èµ„äº§ç±»åˆ«çš„å…¨çƒå®è§‚è§†è§’ï¼Œå®æ—¶ç›‘æ§è‚¡ç¥¨ã€å•†å“ã€è´µé‡‘å±ã€èƒ½æºåŠåŠ å¯†è´§å¸ç­‰æ ¸å¿ƒèµ„äº§ã€‚
            é€šè¿‡å¤šç»´æ•°æ®äº¤å‰éªŒè¯ï¼Œå¿«é€Ÿè¯†åˆ«å¸‚åœºå¤„äº"é£é™©è¿½é€"æŠ‘æˆ–"é˜²å¾¡é¿é™©"çŠ¶æ€ï¼Œä¸ºèµ„äº§é…ç½®å†³ç­–æä¾›æ•°æ®æ”¯æ’‘ã€‚
        </div>
        <div class="header-meta-bar">
            <div>
                ğŸ“… <span id="currentDate">--</span> | 
                â±ï¸ æ›´æ–°: <span id="lastUpdate">--</span> | 
                ğŸ”„ è‡ªåŠ¨åˆ·æ–°: 60s
            </div>
            <button class="refresh-btn" onclick="fetchData()">åˆ·æ–°æ•°æ®</button>
        </div>
    </div>
    
    <div class="container" id="container">
        <div class="loading">æ­£åœ¨åŠ è½½å¸‚åœºæ•°æ®...</div>
    </div>

    <div class="footer-note">
        <strong>æŒ‡æ ‡è¯´æ˜:</strong><br>
        <strong>1D%</strong> = æ—¥æ¶¨è·Œ (å½“æ—¥æ¶¨è·Œå¹…) | <strong>50D%</strong> = 50æ—¥æ¶¨è·Œ (è¿‘50ä¸ªäº¤æ˜“æ—¥æ¶¨è·Œå¹…)<br>
        <strong>REL5</strong> = ç›¸å¯¹5æ—¥ (ç›¸å¯¹äº5ä¸ªäº¤æ˜“æ—¥å‰çš„æ¶¨è·Œå¹…) | <strong>REL20</strong> = ç›¸å¯¹20æ—¥ (ç›¸å¯¹äº20ä¸ªäº¤æ˜“æ—¥å‰çš„æ¶¨è·Œå¹…)<br>
        <strong>Trend</strong> = è¶‹åŠ¿ (20æ—¥ä»·æ ¼èµ°åŠ¿è¿·ä½ å›¾) | <strong>YTD%</strong> = å¹´åˆè‡³ä»Š (æœ¬å¹´åº¦è‡³ä»Šæ¶¨è·Œå¹…)<br><br>
        <strong>æ•°æ®æ¥æº:</strong> Yahoo Finance / Stooqï¼Œæ›´æ–°é¢‘ç‡çº¦15åˆ†é’Ÿå»¶è¿Ÿ<br>
        <strong>é£é™©æç¤º:</strong> æœ¬é¡µé¢ä»…ä¾›å­¦ä¹ äº¤æµï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚å¸‚åœºæœ‰é£é™©ï¼ŒæŠ•èµ„éœ€è°¨æ…ã€‚
    </div>

    <script>
        const sections = {
            'å…¨çƒå¸‚åœº': {
                desc: 'å…¨çƒè‚¡ç¥¨ã€è·¨åœ°åŸŸã€é™ç»´åº¦çš„èµ„äº§é…ç½®â€”â€”è¿™æ˜¯åœ°çƒè§†è§’çš„"ä¸€æ½å­æŠ¼æ³¨"',
                items: ['ACWI', 'VT', 'ACWX']
            },
            'ç¾å›½å¸‚åœº': {
                desc: 'ç¾è‚¡æ ¸å¿ƒèµ„äº§ï¼šå¤§ç›˜è“ç­¹ã€ç§‘æŠ€é¾™å¤´ã€å…¨å¸‚åœºæŒ‡æ•°åŸºé‡‘',
                items: ['VTI', 'SPY', 'QQQ']
            },
            'è´µé‡‘å±ETF': {
                desc: 'å®ç‰©æ”¯æŒçš„è´µé‡‘å±ETFï¼ŒæŠ—é€šèƒ€ã€é¿é™©é…ç½®çš„æ ¸å¿ƒå·¥å…·',
                items: ['GLD', 'SLV', 'PPLT', 'PALL', 'DBC', 'GSG', 'GCC']
            },
            'å‘è¾¾å¸‚åœº': {
                desc: 'æ¬§æ´²ã€æ—¥æœ¬ç­‰å‘è¾¾ç»æµä½“è‚¡ç¥¨æŒ‡æ•°',
                items: ['EFA', 'EZU', 'EWU', 'EWG', 'EWQ', 'EWI', 'EWP', 'EWC', 'EWJ']
            },
            'æ–°å…´å¸‚åœº': {
                desc: 'é«˜å¢é•¿æ½œåŠ›å¸‚åœºï¼šäºšæ´²ã€æ‹‰ç¾ã€éæ´²ç­‰å‘å±•ä¸­ç»æµä½“',
                items: ['EEM', 'EMXC', 'EWY', 'EWS', 'EIDO', 'EZA', 'EWM', 'INDA', 'ARGT', 'VNM', 'EWW', 'EWZ', 'EWT']
            },
            'ä¸­å›½å¸‚åœº': {
                desc: 'Aè‚¡ã€æ¸¯è‚¡ã€ä¸­æ¦‚è‚¡å…¨è¦†ç›–ï¼Œè·Ÿè¸ªä¸­å›½æ ¸å¿ƒèµ„äº§',
                items: ['MCHI', 'FXI', 'KWEB', 'ASHR']
            },
            'è´µé‡‘å±ç°è´§': {
                desc: 'é»„é‡‘ã€ç™½é“¶ç­‰è´µé‡‘å±ç°è´§ä»·æ ¼ï¼Œå…¨çƒé¿é™©èµ„äº§é£å‘æ ‡',
                items: ['XAU', 'XAG', 'XPT', 'XPD']
            },
            'å·¥ä¸šé‡‘å±': {
                desc: 'é“œã€é“ç­‰å·¥ä¸šåŸºç¡€é‡‘å±ï¼Œå…¨çƒç»æµæ´»åŠ¨æ™´é›¨è¡¨',
                items: ['COPPER', 'ALUMINUM']
            },
            'èƒ½æº': {
                desc: 'åŸæ²¹ã€å¤©ç„¶æ°”ç­‰èƒ½æºå•†å“ï¼Œåœ°ç¼˜æ”¿æ²»ä¸ä¾›éœ€åšå¼ˆåœº',
                items: ['WTI', 'BRENT', 'NATGAS']
            },
            'åŠ å¯†è´§å¸': {
                desc: 'æ•°å­—èµ„äº§æ–°çºªå…ƒï¼šBTCã€ETHç­‰ä¸»æµåŠ å¯†è´§å¸',
                items: ['BTC', 'ETH', 'SOL']
            },
            'å®è§‚æŒ‡æ ‡': {
                desc: 'VIXææ…ŒæŒ‡æ•°ã€ç¾å…ƒæŒ‡æ•°ã€ç¾å€ºæ”¶ç›Šç‡ç­‰å…³é”®å®è§‚é£å‘æ ‡',
                items: ['VIX', 'DXY', 'US10Y', 'US02Y', 'US30Y', 'T10Y2Y', 'HY_OAS']
            }
        };

        const etfDetails = {
            'ACWI': { name: 'iShares MSCI ACWI ETF', desc: 'å…¨çƒè‚¡ç¥¨å¸‚åœºé£é™©åå¥½' },
            'VT': { name: 'Vanguard Total World Stock Index Fund ETF', desc: 'å…¨çƒè‚¡ç¥¨è·¨åœ°åŸŸé…ç½®' },
            'ACWX': { name: 'iShares MSCI ACWI ex US ETF', desc: 'å…¨çƒé™¤ç¾è‚¡å¤–å¸‚åœºé£é™©åå¥½' },
            'VTI': { name: 'Vanguard Total Stock Market Index Fund ETF', desc: 'ç¾è‚¡å…¨å¸‚åœºæ•´ä½“é£é™©åå¥½' },
            'SPY': { name: 'SPDR S&P 500 ETF Trust', desc: 'ç¾è‚¡å¤§ç›˜è“ç­¹é£æ ¼è¡¨ç°' },
            'QQQ': { name: 'Invesco QQQ Trust', desc: 'çº³æ–¯è¾¾å…‹ç§‘æŠ€è‚¡é£é™©åå¥½' },
            'EFA': { name: 'iShares MSCI EAFE ETF', desc: 'å‘è¾¾å¸‚åœº(æ¬§/æ¾³/è¿œä¸œ)é£é™©åå¥½' },
            'EZU': { name: 'iShares MSCI Eurozone ETF', desc: 'æ¬§å…ƒåŒºè‚¡å¸‚é£é™©åå¥½' },
            'EWU': { name: 'iShares MSCI United Kingdom ETF', desc: 'è‹±å›½è‚¡å¸‚ä¸è‹±é•‘èµ„äº§é£å‘' },
            'EWG': { name: 'iShares MSCI Germany ETF', desc: 'å¾·å›½åˆ¶é€ ä¸šä¸å‡ºå£å‘¨æœŸé£å‘' },
            'EWQ': { name: 'iShares MSCI France ETF', desc: 'æ³•å›½å¤§ç›˜é£æ ¼è¡¨ç°' },
            'EWI': { name: 'iShares MSCI Italy ETF', desc: 'æ„å¤§åˆ©é£é™©åå¥½ä¸é‡‘èæƒé‡é£å‘' },
            'EWP': { name: 'iShares MSCI Spain ETF', desc: 'è¥¿ç­ç‰™è‚¡å¸‚æ™¯æ°”é£å‘' },
            'EWC': { name: 'iShares MSCI Canada ETF', desc: 'åŠ æ‹¿å¤§èµ„æº+é‡‘èç»“æ„é£å‘' },
            'EWJ': { name: 'iShares MSCI Japan ETF', desc: 'æ—¥æœ¬è‚¡å¸‚ä¸æ—¥å…ƒæ•æ„Ÿé£å‘' },
            'EEM': { name: 'iShares MSCI Emerging Markets ETF', desc: 'æ–°å…´å¸‚åœºæ•´ä½“é£é™©åå¥½' },
            'EMXC': { name: 'iShares MSCI Emerging Markets ex China ETF', desc: 'æ–°å…´å¸‚åœº(é™¤ä¸­å›½)è¡¨ç°' },
            'EWY': { name: 'iShares MSCI South Korea ETF', desc: 'éŸ©å›½åŠå¯¼ä½“å‘¨æœŸé£å‘' },
            'EWS': { name: 'iShares MSCI Singapore ETF', desc: 'æ–°åŠ å¡é‡‘èä¸èˆªè¿é£å‘' },
            'EIDO': { name: 'iShares MSCI Indonesia ETF', desc: 'å°å°¼èµ„æºä¸å†…éœ€é£å‘' },
            'EZA': { name: 'iShares MSCI South Africa ETF', desc: 'å—éèµ„æºå‘¨æœŸä¸æ±‡ç‡æ•æ„Ÿé£å‘' },
            'EWM': { name: 'iShares MSCI Malaysia ETF', desc: 'é©¬æ¥è¥¿äºšå‡ºå£ä¸å•†å“é“¾é£å‘' },
            'INDA': { name: 'iShares MSCI India ETF', desc: 'å°åº¦æˆé•¿ä¸å†…éœ€é£å‘' },
            'ARGT': { name: 'Global X MSCI Argentina ETF', desc: 'é˜¿æ ¹å»·é«˜æ³¢åŠ¨æ”¿ç­–é£æš´é£å‘' },
            'VNM': { name: 'VanEck Vietnam ETF', desc: 'è¶Šå—åˆ¶é€ ä¸šè½¬ç§»å—ç›Šé£å‘' },
            'EWW': { name: 'iShares MSCI Mexico ETF', desc: 'å¢¨è¥¿å“¥åˆ¶é€ ä¸šä¸è¿‘å²¸å¤–åŒ…é£å‘' },
            'EWZ': { name: 'iShares MSCI Brazil ETF', desc: 'å·´è¥¿èµ„æº+åˆ©ç‡æ•æ„Ÿé£å‘' },
            'EWT': { name: 'iShares MSCI Taiwan ETF', desc: 'å°æ¹¾åŠå¯¼ä½“é“¾æ ¸å¿ƒé£å‘' },
            'MCHI': { name: 'iShares MSCI China ETF', desc: 'ä¸­æ¦‚è‚¡å¸‚åœºé£é™©åå¥½' },
            'FXI': { name: 'iShares China Large-Cap ETF', desc: 'ä¸­å›½å¤§ç›˜è“ç­¹(é‡‘è/å¤®ä¼)é£å‘' },
            'KWEB': { name: 'KraneShares CSI China Internet ETF', desc: 'ä¸­å›½äº’è”ç½‘å¹³å°ç›‘ç®¡é£å‘' },
            'ASHR': { name: 'Xtrackers Harvest CSI 300 China A-Shs ETF', desc: 'Aè‚¡æ²ªæ·±300æ ¸å¿ƒèµ„äº§' },
            'GLD': { name: 'SPDR Gold Shares', desc: 'å®ç‰©é»„é‡‘ä¿¡æ‰˜ä»·æ ¼' },
            'SLV': { name: 'iShares Silver Trust', desc: 'å®ç‰©ç™½é“¶ä¿¡æ‰˜ä»·æ ¼' },
            'PPLT': { name: 'Aberdeen Standard Physical Platinum Shares ETF', desc: 'å®ç‰©é“‚é‡‘ä¿¡æ‰˜ä»·æ ¼' },
            'PALL': { name: 'Aberdeen Standard Physical Palladium Shares ETF', desc: 'å®ç‰©é’¯é‡‘ä¿¡æ‰˜ä»·æ ¼' },
            'DBC': { name: 'Invesco DB Commodity Index Tracking Fund', desc: 'å½­åšå¤§å®—å•†å“æŒ‡æ•°è·Ÿè¸ª' },
            'GSG': { name: 'iShares S&P GSCI Commodity-Indexed Trust', desc: 'æ ‡æ™®GSCIå•†å“æŒ‡æ•°è·Ÿè¸ª' },
            'GCC': { name: 'WisdomTree Enhanced Commodity Strategy Fund', desc: 'è¿ç»­å•†å“æŒ‡æ•°å¢å¼ºç­–ç•¥' },
            'XAU': { name: 'Gold Spot', desc: 'ç°è´§é»„é‡‘æœŸè´§ä¸»åŠ›åˆçº¦' },
            'XAG': { name: 'Silver Spot', desc: 'ç°è´§ç™½é“¶æœŸè´§ä¸»åŠ›åˆçº¦' },
            'XPT': { name: 'Platinum Spot', desc: 'ç°è´§é“‚é‡‘æœŸè´§ä¸»åŠ›åˆçº¦' },
            'XPD': { name: 'Palladium Spot', desc: 'ç°è´§é’¯é‡‘æœŸè´§ä¸»åŠ›åˆçº¦' },
            'COPPER': { name: 'Copper Futures', desc: 'ä¼¦é“œæœŸè´§ä¸»åŠ›åˆçº¦' },
            'ALUMINUM': { name: 'Aluminum Futures', desc: 'ä¼¦é“æœŸè´§ä¸»åŠ›åˆçº¦' },
            'WTI': { name: 'WTI Crude Oil', desc: 'WTIåŸæ²¹æœŸè´§ä¸»åŠ›åˆçº¦' },
            'BRENT': { name: 'Brent Crude Oil', desc: 'å¸ƒä¼¦ç‰¹åŸæ²¹æœŸè´§ä¸»åŠ›åˆçº¦' },
            'NATGAS': { name: 'Natural Gas', desc: 'ç¾å›½å¤©ç„¶æ°”æœŸè´§ä¸»åŠ›åˆçº¦' },
            'BTC': { name: 'Bitcoin', desc: 'æ¯”ç‰¹å¸ç¾å…ƒä»·æ ¼' },
            'ETH': { name: 'Ethereum', desc: 'ä»¥å¤ªåŠç¾å…ƒä»·æ ¼' },
            'SOL': { name: 'Solana', desc: 'Solanaç¾å…ƒä»·æ ¼' },
            'VIX': { name: 'CBOE Volatility Index', desc: 'æ ‡æ™®500æ³¢åŠ¨ç‡ææ…ŒæŒ‡æ•°' },
            'DXY': { name: 'U.S. Dollar Index', desc: 'ç¾å…ƒæŒ‡æ•°ä¸€æ½å­è´§å¸' },
            'US10Y': { name: 'US Treasury 10Y Yield', desc: 'ç¾å›½10å¹´æœŸå›½å€ºæ”¶ç›Šç‡' },
            'US02Y': { name: 'US Treasury 2Y Yield', desc: 'ç¾å›½2å¹´æœŸå›½å€ºæ”¶ç›Šç‡' },
            'US30Y': { name: 'US Treasury 30Y Yield', desc: 'ç¾å›½30å¹´æœŸå›½å€ºæ”¶ç›Šç‡' },
            'T10Y2Y': { name: '10Y-2Y Yield Spread', desc: 'ç¾å€º10Y-2YæœŸé™åˆ©å·®' },
            'HY_OAS': { name: 'High Yield OAS', desc: 'é«˜æ”¶ç›Šå€ºä¿¡ç”¨åˆ©å·®' }
        };

        let currentData = {};

        async function fetchData() {
            document.getElementById('container').innerHTML = '<div class="loading">æ­£åœ¨åŠ è½½å¸‚åœºæ•°æ®...</div>';
            
            try {
                const response = await fetch('/api/data');
                const data = await response.json();
                if (data.error) throw new Error(data.error);
                
                currentData = data;
                renderTable();
                
                document.getElementById('currentDate').textContent = new Date().toLocaleDateString('zh-CN');
                document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('zh-CN');
            } catch (error) {
                document.getElementById('container').innerHTML = `<div class="loading" style="color:var(--negative)">åŠ è½½å¤±è´¥: ${error.message}</div>`;
            }
        }

        function renderTable() {
            let html = '';
            
            for (const [sectionName, sectionData] of Object.entries(sections)) {
                html += `
                    <div class="section">
                        <div class="section-title">${sectionName}</div>
                        <div class="section-desc">${sectionData.desc}</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>ä»£ç </th>
                                    <th>åç§°</th>
                                    <th>ä»·æ ¼</th>
                                    <th>1D%</th>
                                    <th>50D%</th>
                                    <th>REL5</th>
                                    <th>REL20</th>
                                    <th>Trend</th>
                                    <th style="text-align:right">YTD%</th>
                                </tr>
                            </thead>
                            <tbody>`;
                
                for (const ticker of sectionData.items) {
                    const d = currentData[ticker] || {};
                    const price = d.price || 0;
                    const change1d = d.change1d || 0;
                    const change50d = d.change50d || 0;
                    const rel5 = d.rel5 || 0;
                    const rel20 = d.rel20 || 0;
                    const ytd = d.ytd || 0;
                    
                    const priceStr = price >= 1000 ? price.toFixed(2) : price >= 1 ? price.toFixed(2) : price.toFixed(4);
                    
                    const details = etfDetails[ticker] || { name: ticker, desc: '' };
                    
                    html += `
                        <tr>
                            <td class="ticker">${ticker}</td>
                            <td class="name">
                                <span class="ename">${details.name}</span>
                                <span class="cdesc">${details.desc}</span>
                            </td>
                            <td class="price">${priceStr}</td>
                            <td class="change ${change1d >= 0 ? 'positive' : 'negative'}">${change1d >= 0 ? '+' : ''}${change1d.toFixed(2)}%</td>
                            <td class="change ${change50d >= 0 ? 'positive' : 'negative'}">${change50d >= 0 ? '+' : ''}${change50d.toFixed(2)}%</td>
                            <td class="change ${rel5 >= 0 ? 'positive' : 'negative'}">${rel5 >= 0 ? '+' : ''}${rel5.toFixed(2)}%</td>
                            <td class="change ${rel20 >= 0 ? 'positive' : 'negative'}">${rel20 >= 0 ? '+' : ''}${rel20.toFixed(2)}%</td>
                            <td>${generateSparkline(d.sparkline || [])}</td>
                            <td class="ytd ${ytd >= 0 ? 'positive' : 'negative'}">${ytd >= 0 ? '+' : ''}${ytd.toFixed(2)}%</td>
                        </tr>`;
                }
                
                html += '</tbody></table></div>';
            }
            
            document.getElementById('container').innerHTML = html;
        }

        function generateSparkline(data) {
            if (!data || data.length < 2) return '';
            const width = 50, height = 20;
            const min = Math.min(...data), max = Math.max(...data);
            const range = max - min || 1;
            
            const points = data.map((v, i) => {
                const x = (i / (data.length - 1)) * width;
                const y = height - ((v - min) / range) * height;
                return `${x.toFixed(1)},${y.toFixed(1)}`;
            }).join(' ');
            
            const color = data[data.length - 1] >= data[0] ? 'var(--positive)' : 'var(--negative)';
            
            return `<svg class="sparkline" viewBox="0 0 50 20">
                <polyline fill="none" stroke="${color}" stroke-width="1.5" points="${points}"/>
            </svg>`;
        }

        fetchData();
        setInterval(fetchData, 60000);
    </script>
</body>
</html>
